{"version":3,"sources":["webpack:///E:/code/git/Fixed-Assets-Management-System/uni/fams/components/crop.vue?3d93","webpack:///E:/code/git/Fixed-Assets-Management-System/uni/fams/components/crop.vue?c566","webpack:///E:/code/git/Fixed-Assets-Management-System/uni/fams/components/crop.vue?9ecd","webpack:///E:/code/git/Fixed-Assets-Management-System/uni/fams/components/crop.vue?731f","webpack:///E:/code/git/Fixed-Assets-Management-System/uni/fams/components/crop.vue","webpack:///E:/code/git/Fixed-Assets-Management-System/uni/fams/components/crop.vue?3894","webpack:///E:/code/git/Fixed-Assets-Management-System/uni/fams/components/crop.vue?41c0"],"names":["tailorSize","newOffsetX","newOffsetY","name","props","pictureSrc","type","String","required","data","offsetX","offsetY","img_width","img_height","img_scaling","scale","scaleMin","isShow","watch","getImgInfo","methods","onShow","onHide","uni","getImageInfo","src","success","res","width","height","sysInfo","getSystemInfoSync","windowWidth","windowHeight","count","movableChange","e","detail","x","y","movableScale","createImg","ctx","createCanvasContext","drawImage","draw","canvasToTempFilePath","destWidth","destHeight","canvasId","$emit","tempFilePath"],"mappings":"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","file":"components/crop.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./crop.vue?vue&type=template&id=124d4d7e&\"\nvar renderjs\nimport script from \"./crop.vue?vue&type=script&lang=js&\"\nexport * from \"./crop.vue?vue&type=script&lang=js&\"\nimport style0 from \"./crop.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"E:/code/git/Fixed-Assets-Management-System/uni/fams/components/crop.vue\"\nexport default component.exports","export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./crop.vue?vue&type=template&id=124d4d7e&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./crop.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./crop.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nlet tailorSize = 512; // 需要截取的尺寸240x240px，此变量要和样式中的240px和120px相对应，120px为此变量的一半，若要修改成其他值一定要一一对应\nlet\tnewOffsetX = 0; // 拖动缩放完成后的X轴偏移量\nlet newOffsetY = 0; // 拖动缩放完成后的Y轴偏移量\n\nexport default {\n\tname: \"crop\",\n\tprops: {\n\t\t// 图片路径\n\t\tpictureSrc: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\toffsetX: 0, // 图像初始化的X轴偏移量\n\t\t\toffsetY: 0, // 图像初始化的Y轴偏移量\n\t\t\timg_width: 0, // 图片真实宽度\n\t\t\timg_height: 0, // 图片真实高度\n\t\t\timg_scaling: 5, //图片初始化缩放比例\n\t\t\tscale: 1, // 拖动缩放完成后的图片缩放比例\n\t\t\tscaleMin: 0.1, // 最小缩放值\n\t\t\tisShow: false\n\t\t};\n\t},\n\twatch: {\n\t\tpictureSrc() {\n\t\t\tthis.getImgInfo();\n\t\t}\n\t},\n\tmethods: {\n\t\t// 显示组件\n\t\tonShow() {\n\t\t\tthis.isShow = true;\n\t\t},\n\t\t// 隐藏组件\n\t\tonHide() {\n\t\t\tthis.isShow = false;\n\t\t},\n\t\t// 初始化图片\n\t\tgetImgInfo() {\n\t\t\tuni.getImageInfo({\n\t\t\t\tsrc: this.pictureSrc,\n\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t// 图片宽高\n\t\t\t\t\tthis.img_width = res.width;\n\t\t\t\t\tthis.img_height = res.height;\n\t\t\t\t\t// 屏幕可用宽高\n\t\t\t\t\tlet sysInfo = uni.getSystemInfoSync();\n\t\t\t\t\tlet windowWidth = sysInfo.windowWidth;\n\t\t\t\t\tlet windowHeight = sysInfo.windowHeight;\n\t\t\t\t\t\n\t\t\t\t\t// 计算初始缩放比和最小缩放值\n\t\t\t\t\tif (this.img_width < tailorSize || this.img_height < tailorSize) { // 当图片宽或高小于240px时\n\t\t\t\t\t\tlet count = this.img_width <= this.img_height ? this.img_width : this.img_height;\n\t\t\t\t\t\tthis.img_scaling = count / tailorSize;\n\t\t\t\t\t\tthis.scaleMin = 1;\n\t\t\t\t\t} else if (this.img_width > windowWidth && this.img_width <= this.img_height) { // 当图片宽度大于屏幕宽度并且图片宽度小于图片高度时\n\t\t\t\t\t\tthis.img_scaling = this.img_width / windowWidth;\n\t\t\t\t\t\tthis.scaleMin = tailorSize / windowWidth;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet count = this.img_width <= this.img_height ? this.img_width : this.img_height;\n\t\t\t\t\t\tthis.scaleMin = tailorSize / count;\n\t\t\t\t\t}\n\n\t\t\t\t\t// 计算图片居中显示时的偏移量\n\t\t\t\t\tthis.offsetX = -(this.img_width / this.img_scaling / 2 - tailorSize / 2);\n\t\t\t\t\tthis.offsetY = -(this.img_height / this.img_scaling / 2 - tailorSize / 2);\n\t\t\t\t\t// 获取新的偏移量\n\t\t\t\t\tnewOffsetX = this.offsetX;\n\t\t\t\t\tnewOffsetY = this.offsetY;\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\t// 计算拖动偏移量\n\t\tmovableChange(e) {\n\t\t\tnewOffsetX = e.detail.x\n\t\t\tnewOffsetY = e.detail.y\n\t\t},\n\t\t// 计算缩放比例和偏移量\n\t\tmovableScale(e) {\n\t\t\tnewOffsetX = e.detail.x\n\t\t\tnewOffsetY = e.detail.y\n\t\t\tthis.scale = e.detail.scale;\n\t\t},\n\t\t// 截取图片\n\t\tcreateImg() {\n\t\t\tlet ctx = uni.createCanvasContext(\"picture-canvas\");\n\t\t\tctx.drawImage(this.pictureSrc, newOffsetX, newOffsetY, this.img_width /\n\t\t\t\tthis.img_scaling * this.scale,\n\t\t\t\tthis.img_height / this.img_scaling * this.scale);\n\t\t\tctx.draw(false, () => {\n\t\t\t\tuni.canvasToTempFilePath({\n\t\t\t\t\t// 截取图片尺寸\n\t\t\t\t\tdestWidth: tailorSize / 2,\n\t\t\t\t\tdestHeight: tailorSize / 2,\n\t\t\t\t\tcanvasId: \"picture-canvas\",\n\t\t\t\t\tsuccess: (res) => {\n\t\t\t\t\t\t// console.log(res.tempFilePath)\n\t\t\t\t\t\t// this.onHide();\n\t\t\t\t\t\tthis.isShow = false\n\t\t\t\t\t\tthis.$emit(\"uploadF\", res.tempFilePath)\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n}\n","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./crop.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./crop.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1591927249195\n      var cssReload = require(\"D:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}